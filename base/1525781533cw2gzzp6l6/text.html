<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Путь первый. Через картирование ридов на референсный геном.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">1. Удаление человеческой ДНК из сиквенсов:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-weight:600; color:#000000; background-color:#ffffff;">kneaddata</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">--input</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">transren498_S3_L001_1.fastq</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">   </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">--input</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">transren498_S3_L001_2.fast</span><span style=" font-family:'monospace';"><br />q</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">   </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-db</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">/home/slava/work/homoSapiens/db/</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">--output</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">498TrimmHumanDNA</span><span style=" font-family:'monospace';"><br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">в папке сохраняются сиквенсы с контаминацией и без</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">2. Получаем pileup файл с картированными ридами на геном, с глубиной прочтения 3</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-weight:600; color:#000000; background-color:#ffffff;">samtools</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">depth</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-q</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">3</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">transren450.sort.bam</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'monospace'; color:#5454ff; background-color:#ffffff;">&gt;450_pileup.txt</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#5454ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">NC_000962       15368   2 </span><span style=" font-family:'monospace';"><br />NC_000962       15369   2 <br />NC_000962       15370   2 <br />NC_000962       15371   2 <br />NC_000962       15372   2 <br />NC_000962       15373   2 <br />NC_000962       15374   2 <br />NC_000962       15375   2 <br />NC_000962       15376   2 <br />NC_000962       15377   2<br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">2.1 Можно сделать иначе, но результат схожий:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-weight:600; color:#000000; background-color:#ffffff;">samtools</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">mpileup</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-C</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">10</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-f</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">h37rv.fasta</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">transren450.sort.bam</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#5454ff; background-color:#ffffff;">&gt;450_pileup.txt</span><span style=" font-family:'monospace';"><br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">NC_000962       15368   G       1       ^I.     ; </span><span style=" font-family:'monospace';"><br />NC_000962       15369   C       1       .       l <br />NC_000962       15370   A       1       .       l <br />NC_000962       15371   G       1       .       l <br />NC_000962       15372   C       1       .       k <br />NC_000962       15373   G       1       .       j <br />NC_000962       15374   G       1       .       l <br />NC_000962       15375   T       1       .       m <br />NC_000962       15376   G       1       .       i <br />NC_000962       15377   T       1       .       l<br /><br /></span><span style=" font-family:'monospace';"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">3. При помощи моей программы находим начало и конец картированных ридов, сохраняя его в файл для загрузки в circos (th -трешхолд глубины покрытия, -n имя штамма, -s имя генома)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-weight:600; color:#000000; background-color:#ffffff;">./coord2circos</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-i=450_pileup.txt</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">   </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-th</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">1</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-n</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">450</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-s</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">H37Rv</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#5454ff; background-color:#ffffff;">&gt;</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#5454ff; background-color:#ffffff;">450Coords.txt</span><span style=" font-family:'monospace';"><br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">H37Rv 15368 15386 450L18 </span><span style=" font-family:'monospace';"><br />H37Rv 39916 39938 450L22 <br />H37Rv 117284 117303 450L19 <br />H37Rv 176279 176297 450L18 <br />H37Rv 218745 218763 450L18 <br />H37Rv 228772 228790 450L18 <br />H37Rv 285748 285766 450L18 <br />H37Rv 286321 286339 450L18 <br />H37Rv 357574 357593 450L19 <br />H37Rv 359426 359444 450L18<br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">4. Сохраняем ТОЛЬКО координаты позиций для дальнейшего аннотирования</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-weight:600; color:#000000; background-color:#ffffff;">cut</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-f</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">2,3</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">450Coords.txt</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#5454ff; background-color:#ffffff;">&gt;450CoordsOnly.txt</span><span style=" font-family:'monospace';"><br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">15368   15386 </span><span style=" font-family:'monospace';"><br />39916   39938 <br />117284  117303 <br />176279  176297 <br />218745  218763 <br />228772  228790 <br />285748  285766 <br />286321  286339 <br />357574  357593 <br />359426  359444<br /><br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">5. Аннотируем при помощи bsatool и убираем все лишнее. -th 100 удаляет все последовательности, длиннее 100. в данном случае нужно для удаления спорных рРНК регионов.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-weight:600; color:#000000; background-color:#ffffff;">./bsatool</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-db=test_core</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-test=range</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-in</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">450CoordsOnly.txt</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-th</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">100</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'monospace'; color:#ff54ff; background-color:#ffffff;">|</span><span style=" font-family:'monospace'; font-weight:600; color:#000000; background-color:#ffffff;">cut</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-f</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">1</span><span style=" font-family:'monospace';"><br />,2,3,4,5</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#5454ff; background-color:#ffffff;">&gt;</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#5454ff; background-color:#ffffff;">450Annotated.txt</span><span style=" font-family:'monospace';"><br /><br /><br /></span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">Rv0013  15368   15386   18      cagcggtgtgatcatggc </span><span style=" font-family:'monospace';"><br />Rv0037c 39916   39938   22      gtgtgcaccaccagcccggcta <br />Rv0101  117284  117303  19      tttgaggccagcctgggcg <br />Rv0149  176279  176297  18      gctgggctcagcaggtgc <br />Rv0187  218745  218763  18      atttttggacagcacact <br />Rv0194  228772  228790  18      gttggtggccgtgcagac <br />Rv0236c 285748  285766  18      agcaccaggggcagccgg <br />Rv0236c 286321  286339  18      agcccggcttgggcggcc <br />Rv0293c 357574  357593  19      ggcgccagtgctgcgcgtg <br />Rv0295c 359426  359444  18      gcgcagtctgattccaca<br /><br /><br /><br /><br /><br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"><br /><br /></span></p></body></html>
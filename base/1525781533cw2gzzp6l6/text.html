<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Путь первый. Через картирование ридов на референсный геном.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">1. Удаление человеческой ДНК из сиквенсов:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-weight:600; color:#000000; background-color:#ffffff;">kneaddata</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">--input</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">transren498_S3_L001_1.fastq</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">   </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">--input</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">transren498_S3_L001_2.fast</span><span style=" font-family:'monospace';"><br />q</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">   </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-db</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">/home/slava/work/homoSapiens/db/</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">--output</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">498TrimmHumanDNA</span><span style=" font-family:'monospace';"><br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">в папке сохраняются сиквенсы с контаминацией и без</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">2. Генерируем mpileup файл</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-weight:600; color:#000000; background-color:#ffffff;">samtools</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">mpileup</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-C</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">10</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-f</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">h37rv.fasta</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">transren450.sort.bam</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#5454ff; background-color:#ffffff;">&gt;450_mpileup.txt</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#5454ff;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#5454ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">NC_000962       15368   G       1       ^I.     ; </span><span style=" font-family:'monospace';"><br />NC_000962       15369   C       1       .       l <br />NC_000962       15370   A       1       .       l <br />NC_000962       15371   G       1       .       l <br />NC_000962       15372   C       1       .       k <br />NC_000962       15373   G       1       .       j <br />NC_000962       15374   G       1       .       l <br />NC_000962       15375   T       1       .       m <br />NC_000962       15376   G       1       .       i <br />NC_000962       15377   T       1       .       l<br /><br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#5454ff;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#5454ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-weight:600; color:#000000; background-color:#ffffff;">./coord2circos</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-i</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">450_mpileup.txt</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">     </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-th</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">1</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-n</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">450</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-s</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">H37Rv</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-mkseq</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#5454ff; background-color:#ffffff;">&gt;450Seq.t</span><span style=" font-family:'monospace';"><br />xt<br /><br /></span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">&gt;450L18:15369:15386 </span><span style=" font-family:'monospace';"><br />CAGCGGTGTGATCATGGC <br />&gt;450L22:39917:39938 <br />GTGTGCACCACCAGCCCGGCTA <br />&gt;450L19:117285:117303 <br />TTTGAGGCCAGCCTGGGCG <br />&gt;450L18:176280:176297 <br />GCTGGGCTCAGCAGGTGC <br />&gt;450L18:218746:218763 <br />ATTTTTGGACAGCACACT<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-weight:600; color:#000000; background-color:#ffffff;">blastn</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-db</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">h37rv</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-query</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">450Seq.txt</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-task</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">blastn-short</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">   </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-outfmt</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">6</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-perc_iden</span><span style=" font-family:'monospace';"><br />tity</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">100</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-num_alignments</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">1</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-word_size</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">16</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-evalue</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">0.001</span><span style=" font-family:'monospace'; color:#ff54ff; background-color:#ffffff;">|</span><span style=" font-family:'monospace'; font-weight:600; color:#000000; background-color:#ffffff;">cut</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-f</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">1,2,4,9,10</span><span style=" font-family:'monospace';"><br /><br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">450L18:15369:15386      NC_000962       18      15369   15386 </span><span style=" font-family:'monospace';"><br />450L22:39917:39938      NC_000962       22      39917   39938 <br />450L19:117285:117303    NC_000962       19      117285  117303 <br />450L18:176280:176297    NC_000962       18      176280  176297 <br />450L18:218746:218763    NC_000962       18      218746  218763 <br />450L18:286322:286339    NC_000962       18      286322  286339 <br />450L18:357575:357592    NC_000962       18      357575  357592 <br />450L18:359427:359444    NC_000962       18      359427  359444 <br />450L19:425651:425669    NC_000962       19      425651  425669 <br />450L18:446548:446565    NC_000962       18      446548  446565</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">Так, мы получили 100% специфичные последовательности MTB. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">удаление человеческой ДНК -&gt; картирование на референсный геном -&gt; сохранение </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">последовательности из картированных ридов -&gt; проверка их бластом и отбор 100%</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">идентичных со значением evalue 0.001</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"><br /><br />Думаю, такой способ более честный, чем поиск бластом по в пункте 7.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">Сохраняем координаты из БЛАСТ-файла в отдельный файл</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-weight:600; color:#000000; background-color:#ffffff;">cat</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">450Blast.txt</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#ff54ff; background-color:#ffffff;">|</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; font-weight:600; color:#000000; background-color:#ffffff;">cut</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-f</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">4,5</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#5454ff; background-color:#ffffff;">&gt;450CoordsOnly.txt</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace';"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">15369   15386 </span><span style=" font-family:'monospace';"><br />39917   39938 <br />117285  117303 <br />176280  176297 <br />218746  218763 <br />286322  286339 <br />357575  357592 <br />359427  359444 <br />425651  425669 <br />446548  446565<br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">Аннотируем полученные координаты </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-weight:600; color:#000000; background-color:#ffffff;">/bsatool</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-db=test_core</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-test=range</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-in</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">450CoordsOnly.txt</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-th</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">100</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#5454ff; background-color:#ffffff;">&gt;</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#5454ff; background-color:#ffffff;">450Annot</span><span style=" font-family:'monospace';"><br />ated.txt</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace';"><br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">Rv0013  15370   15386   17      agcggtgtgatcatggc       Possible anthranilate synthase component II TrpG (glutami</span><span style=" font-family:'monospace';"><br />ne amidotransferase)  <br />Rv0037c 39918   39938   21      tgtgcaccaccagcccggcta   Probable conserved integral membrane protein  <br />Rv0101  117286  117303  18      ttgaggccagcctgggcg      Probable peptide synthetase Nrp (peptide synthase)  <br />Rv0149  176281  176297  17      ctgggctcagcaggtgc       Possible quinone oxidoreductase (NADPH:quinone oxidoreduc<br />tase) (zeta-crystallin)  <br />Rv0187  218747  218763  17      tttttggacagcacact       Probable O-methyltransferase  <br />Rv0236c 286323  286339  17      gcccggcttgggcggcc       Possible arabinofuranosyltransferase AftD  <br />Rv0293c 357576  357592  17      gcgccagtgctgcgcgt       Conserved protein  <br />Rv0295c 359428  359444  17      cgcagtctgattccaca       Conserved protein  <br />Rv0355c 425652  425669  18      gcaaccacccagccaggt      PPE family protein PPE8  <br />Rv0369c 446549  446565  17      cacccagatcagcagca       Possible membrane oxidoreductase <br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">Объединяем все БЛАСТ файлы, в редакторе меняя последовательность полей для circos</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">H37Rv	15369	15386	450L18:15369:15386</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">H37Rv	39917	39938	450L22:39917:39938</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">H37Rv	117285	117303	450L19:117285:117303</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">H37Rv	176280	176297	450L18:176280:176297</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">H37Rv	218746	218763	450L18:218746:218763</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">H37Rv	286322	286339	450L18:286322:286339</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">H37Rv	357575	357592	450L18:357575:357592</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">H37Rv	359427	359444	450L18:359427:359444</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"><br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">Теперь переходим к анализу ридов magicblast-ом</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">Очищенные от человеческой ДНК риды прогоняем через бласт.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">1. </span><span style=" font-family:'monospace'; font-weight:600; color:#000000; background-color:#ffffff;">./makeblastdb</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-in</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">h37rv.fasta</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-parse_seqids</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-dbtype</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">nucl</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-out</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">h37rv</span><span style=" font-family:'monospace';"><br /><br />создаем базу генома</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">2. </span><span style=" font-family:'monospace'; font-weight:600; color:#000000; background-color:#ffffff;">./magicblast</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-query</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">transren450_S1_L001_1_kneaddata_paired_1.fastq</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-query_mat</span><span style=" font-family:'monospace';"><br />e</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">transren450_S1_L001_1_kneaddata_paired_2.fastq</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">   </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-db</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">h37rv</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-infmt</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">fastq</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-no_unaligned</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-outfmt</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">tabular</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-perc_ide</span><span style=" font-family:'monospace';">ntity</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">100</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#5454ff; background-color:#ffffff;">&gt;450FromMagic.txt</span><span style=" font-family:'monospace';"><br /><br /></span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"># MAGICBLAST 1.3.0 </span><span style=" font-family:'monospace';"><br /># ./magicblast -query transren450_S1_L001_1_kneaddata_paired_1.fastq -query_mate transren450_S1_L001_1_kneaddata_<br />paired_2.fastq -db h37rv -infmt fastq -no_unaligned -outfmt tabular -perc_identity 100  <br /># Fields: query acc.    reference acc.  % identity      not used        not used        not used        query sta<br />rt      query end       reference start reference end   not used        not used        score   query strand    r<br />eference strand query length    BTOP    num placements  not used        compartment     left overhang   right ove<br />rhang   mate reference  mate ref. start composite score <br />M03106:10:000000000-BJWV8:1:1101:10473:1817     NC_000962       100     0       0       0       45      66      1<br />472229  1472250 0       99      22      plus    plus    271     22      1       -       1:0     GTTTCCCCCATTGTGCA<br />ATATTCCCCACTG   AGCGAAGAAGTATCTCGGTATGTAAAGCTC  -       -       22 <br />M03106:10:000000000-BJWV8:1:1101:27222:6295     NC_000962       100     0       0       0       169     192     1<br />472350  1472373 0       99      24      plus    plus    301     24      1       -       1:1     GAATTAGCCGGTCCTTA<br />TTCGTATGGTACC   GAAGGTCCAGGCGTTATCCGGATTTATTGG  -       -       24 <br />M03106:10:000000000-BJWV8:1:1101:6114:14669     NC_000962       100     0       0       0       32      53      5<br />5534    55555   0       99      22      plus    plus    248     22      1       -       1:2     CTCCTGGGTCTCGCCCT<br />CCCCCTGGCCCTC   CCCGCCGCCAGGAGCAGACCCTGCGTGATG  -       -       22 <br />M03106:10:000000000-BJWV8:1:1101:13802:16743    NC_000962       100     0       0       0       188     207     4<br />149198  4149179 0       99      20      plus    minus   225     20      1       -       1:3     TGAGAGCTCGGGAGCTG<br />GGACATCCAGCTG   GAGCCCTTCGTGGCTGCC      -       4149179 40 <br />M03106:10:000000000-BJWV8:1:1101:13802:16743    NC_000962       100     0       0       0       29      48      4<br />149179  4149198 0       99      20      plus    plus    210     20      1       -       1:3     GAGCCCTTCGTGGCTGC<br />CGGGAAAGAAT     TGAGAGCTCGGGAGCTGGGACATCCAGCTG  -       4149198 40 <br />M03106:10:000000000-BJWV8:1:1102:3718:6284      NC_000962       100     0       0       0       169     192     1<br />472350  1472373 0       99      24      plus    plus    269     24      1       -       1:4     GAATTAGCCGGTCCTTA<br />TTCATGCGGTACC   GAAGGTCCGGGCGTTATCCGGATTTATTGG  -       -       24<br /><br />3. Сохраняем координаты последовательностей в отдельный файл: </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">отбираем только координаты, сортируем данные в виде чисел.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-weight:600; color:#000000; background-color:#ffffff;">cut</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-f</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">9,10</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">450FromMagic.txt</span><span style=" font-family:'monospace'; color:#ff54ff; background-color:#ffffff;">|</span><span style=" font-family:'monospace'; font-weight:600; color:#000000; background-color:#ffffff;">grep</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-P</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#b26818; background-color:#ffffff;">&quot;^(\d+)\W+(\d+)&quot;</span><span style=" font-family:'monospace'; color:#ff54ff; background-color:#ffffff;">|</span><span style=" font-family:'monospace'; font-weight:600; color:#000000; background-color:#ffffff;">sort</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-n</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#5454ff; background-color:#ffffff;">&gt;450FromMagicCo</span><span style=" font-family:'monospace';"><br />ords.txt<br /><br /></span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">39916   39938 </span><span style=" font-family:'monospace';"><br />39938   39916 <br />55534   55555 <br />97905   97886 <br />108170  108151 <br />357574  357593 <br />357593  357574 <br />425650  425669 <br />425669  425650 <br />439672  439653<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">4. Аннотируем координаты при помощи bsatool</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-weight:600; color:#000000; background-color:#ffffff;">./bsatool</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-db=test_core</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-test=range</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-in</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">450FromMagicCoords.txt</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-th</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">100</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-opt</span><span style=" font-family:'monospace';"><br /></span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">uniq</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#5454ff; background-color:#ffffff;">&gt;</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#5454ff; background-color:#ffffff;">450FromMagicAnnotated.txt</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#5454ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">-th устанавливает трешхолд длины последовательности в 100 п.н </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">-opt uniq показывает последовательности в одном экземпляре</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">последняя цифра показывает количество последовательностей в файле.<br /><br /></span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">Rv0037c 39917   39938   22      gtgtgcaccaccagcccggcta  Probable conserved integral membrane protein    2 </span><span style=" font-family:'monospace';"><br />Rv0050  55535   55555   21      ccgccgccgccgccgccgccg   Probable bifunctional penicillin-binding protein 1A/1B Po<br />nA1 (murein polymerase) (PBP1): penicillin-insensitive transglycosylase (peptidoglycan TGASE) + penicillin-sensit<br />ive transpeptidase (DD-transpeptidase)  1 <br />Rv0089  97887   97905   19      ataccctacgtcacggcag     Possible methyltransferase/methylase    1 <br />-       108152  108170  19      tccaatgggaggaaagaag             1 <br />Rv0293c 357575  357593  19      ggcgccagtgctgcgcgtg     Conserved protein       2 <br />Rv0355c 425651  425669  19      tgcaaccacccagccaggt     PPE family protein PPE8         2 <br />-       439654  439672  19      aggattggctggtttgccc             1 <br />Rv0369c 446548  446566  19      gcacccagatcagcagcag     Possible membrane oxidoreductase        2 <br />-       526084  526102  19      gggtcatcttacggagctt             2<br /><br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"><br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">!!!----------------------------------------------------------------<br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">Это старый путь. Оставил на всякий случай.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">2. Получаем pileup файл с картированными ридами на геном, с глубиной прочтения 3</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-weight:600; color:#000000; background-color:#ffffff;">samtools</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">depth</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-q</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">3</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">transren450.sort.bam</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'monospace'; color:#5454ff; background-color:#ffffff;">&gt;450_pileup.txt</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#5454ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">NC_000962       15368   2 </span><span style=" font-family:'monospace';"><br />NC_000962       15369   2 <br />NC_000962       15370   2 <br />NC_000962       15371   2 <br />NC_000962       15372   2 <br />NC_000962       15373   2 <br />NC_000962       15374   2 <br />NC_000962       15375   2 <br />NC_000962       15376   2 <br />NC_000962       15377   2<br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">2.1 Можно сделать иначе, но результат схожий:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-weight:600; color:#000000; background-color:#ffffff;">samtools</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">mpileup</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-C</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">10</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-f</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">h37rv.fasta</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">transren450.sort.bam</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#5454ff; background-color:#ffffff;">&gt;450_mpileup.txt</span><span style=" font-family:'monospace';"><br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">NC_000962       15368   G       1       ^I.     ; </span><span style=" font-family:'monospace';"><br />NC_000962       15369   C       1       .       l <br />NC_000962       15370   A       1       .       l <br />NC_000962       15371   G       1       .       l <br />NC_000962       15372   C       1       .       k <br />NC_000962       15373   G       1       .       j <br />NC_000962       15374   G       1       .       l <br />NC_000962       15375   T       1       .       m <br />NC_000962       15376   G       1       .       i <br />NC_000962       15377   T       1       .       l<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">3. При помощи моей программы находим начало и конец картированных ридов, сохраняя его в файл для загрузки в circos (th -трешхолд глубины покрытия, -n имя штамма, -s имя генома)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-weight:600; color:#000000; background-color:#ffffff;">./coord2circos</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-i=450_pileup.txt</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">   </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-th</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">1</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-n</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">450</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-s</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">H37Rv</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#5454ff; background-color:#ffffff;">&gt;</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#5454ff; background-color:#ffffff;">450Coords.txt</span><span style=" font-family:'monospace';"><br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">H37Rv 15368 15386 450L18 </span><span style=" font-family:'monospace';"><br />H37Rv 39916 39938 450L22 <br />H37Rv 117284 117303 450L19 <br />H37Rv 176279 176297 450L18 <br />H37Rv 218745 218763 450L18 <br />H37Rv 228772 228790 450L18 <br />H37Rv 285748 285766 450L18 <br />H37Rv 286321 286339 450L18 <br />H37Rv 357574 357593 450L19 <br />H37Rv 359426 359444 450L18<br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">4. Сохраняем ТОЛЬКО координаты позиций для дальнейшего аннотирования</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-weight:600; color:#000000; background-color:#ffffff;">cut</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-f</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">2,3</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">450Coords.txt</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#5454ff; background-color:#ffffff;">&gt;450CoordsOnly.txt</span><span style=" font-family:'monospace';"><br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">15368   15386 </span><span style=" font-family:'monospace';"><br />39916   39938 <br />117284  117303 <br />176279  176297 <br />218745  218763 <br />228772  228790 <br />285748  285766 <br />286321  286339 <br />357574  357593 <br />359426  359444<br /><br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">5. Аннотируем при помощи bsatool и убираем все лишнее. -th 100 удаляет все последовательности, длиннее 100. в данном случае нужно для удаления спорных рРНК регионов.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-weight:600; color:#000000; background-color:#ffffff;">./bsatool</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-db=test_core</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-test=range</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-in</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">450CoordsOnly.txt</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-th</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">100</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'monospace'; color:#ff54ff; background-color:#ffffff;">|</span><span style=" font-family:'monospace'; font-weight:600; color:#000000; background-color:#ffffff;">cut</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-f</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">1</span><span style=" font-family:'monospace';"><br />,2,3,4,5</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#5454ff; background-color:#ffffff;">&gt;</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#5454ff; background-color:#ffffff;">450Annotated.txt</span><span style=" font-family:'monospace';"><br /><br /><br /></span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">Rv0013  15368   15386   18      cagcggtgtgatcatggc </span><span style=" font-family:'monospace';"><br />Rv0037c 39916   39938   22      gtgtgcaccaccagcccggcta <br />Rv0101  117284  117303  19      tttgaggccagcctgggcg <br />Rv0149  176279  176297  18      gctgggctcagcaggtgc <br />Rv0187  218745  218763  18      atttttggacagcacact <br />Rv0194  228772  228790  18      gttggtggccgtgcagac <br />Rv0236c 285748  285766  18      agcaccaggggcagccgg <br />Rv0236c 286321  286339  18      agcccggcttgggcggcc <br />Rv0293c 357574  357593  19      ggcgccagtgctgcgcgtg <br />Rv0295c 359426  359444  18      gcgcagtctgattccaca<br /><br />6. Для дополнительной проверки последовательностей БЛАСТОМ, сохраняем последовательности в файл</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-weight:600; color:#000000; background-color:#ffffff;">./bsatool</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-db=test_core</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-test=range</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-in</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">450CoordsOnly.txt</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-th</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">100</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-opt=makes</span><span style=" font-family:'monospace';"><br />eq</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#5454ff; background-color:#ffffff;">&gt;</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#5454ff; background-color:#ffffff;">450Seq.txt</span><span style=" font-family:'monospace';"><br /><br /></span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">&gt;Rv0005:6756:6774:19 </span><span style=" font-family:'monospace';"><br />tcacggcgctgggcaccgg <br />&gt;Rv0035:38104:38121:18 <br />gcgcggcgccgacatcga <br />&gt;Rv0039c:42241:42259:19 <br />gcgcagcgccagcgccgtg <br />&gt;Rv0050:55535:55555:21 <br />ccgccgccgccgccgccgccg <br />&gt;Rv0068:75391:75408:18 <br />gccgcagcgcttgccgcc<br /><br />7. Проверяем их бластом. На самом деле ХЗ для чего это я делаю, ведь я генерирую последовательность из референса и она должна совпадать безусловно с регионом. Но решил извратиться так.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">Важные ключи: -word-size размер длины искомой последовательности, -task blastn-short поиск коротких последовательностей, -value 0.001 фильтрует всякий шлак :) -outfmt 10 выдает в виде таблицы</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-weight:600; color:#000000; background-color:#ffffff;">blastn</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-db</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">h37rv</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-query</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">450Seq.txt</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-task</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">blastn-short</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">   </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-outfmt</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">10</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-perc_ide</span><span style=" font-family:'monospace';"><br />ntity</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">100</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-num_alignments</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">1</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-word_size</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">16</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">-evalue</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#18b2b2; background-color:#ffffff;">0.001</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#5454ff; background-color:#ffffff;">&gt;</span><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'monospace'; color:#5454ff; background-color:#ffffff;">450Blast.txt</span><span style=" font-family:'monospace';"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#ffffff;">Rv0005:6756:6774:19,NC_000962,100.000,19,0,0,1,19,6756,6774,1.01e-04,38.2 </span><span style=" font-family:'monospace';"><br />Rv0035:38104:38121:18,NC_000962,100.000,18,0,0,1,18,38104,38121,3.41e-04,36.2 <br />Rv0039c:42241:42259:19,NC_000962,100.000,19,0,0,1,19,42241,42259,1.01e-04,38.2 <br />Rv0068:75391:75408:18,NC_000962,100.000,18,0,0,1,18,75391,75408,3.41e-04,36.2 <br />Rv0083:91595:91612:18,NC_000962,100.000,18,0,0,1,18,91595,91612,3.41e-04,36.2 <br />Rv0087:96263:96280:18,NC_000962,100.000,18,0,0,1,18,96263,96280,3.41e-04,36.2 <br />Rv0098:107891:107908:18,NC_000962,100.000,18,0,0,1,18,107891,107908,3.41e-04,36.2 <br />Rv0101:110508:110526:19,NC_000962,100.000,19,0,0,1,19,110508,110526,1.01e-04,38.2 <br />Rv0101:114110:114127:18,NC_000962,100.000,18,0,0,1,18,114110,114127,3.41e-04,36.2 <br />Rv0101:117285:117302:18,NC_000962,100.000,18,0,0,1,18,117285,117302,3.41e-04,36.2<br /><br /><br /><br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"><br /><br /></span></p></body></html>